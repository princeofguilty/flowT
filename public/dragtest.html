<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draw Line on Drag</title>
    <style>
        #elementX, #elementY {
            width: 100px;
            height: 100px;
            background-color: lightblue;
            border: 2px solid black;
            margin: 50px;
            display: inline-block;
            text-align: center;
            line-height: 100px;
            font-size: 18px;
            position: absolute;
        }
        #elementX {
            top: 100px;
            left: 100px;
        }
        #elementY {
            top: 100px;
            left: 400px;
        }
        /* Style for the line */
        .line {
            position: absolute;
            background-color: red;
            height: 2px;
            transform-origin: 0 0; /* Set rotation origin */
        }
    </style>
</head>
<body>

<div id="elementX" draggable="true">Element X</div>
<div id="elementY">Element Y</div>

<script>
    const elementX = document.getElementById('elementX');
    const elementY = document.getElementById('elementY');
    let dragSource = null;
    let line = null;

    // Function to get the center coordinates of an element, accounting for scroll
    function getCenterCoordinates(element) {
        const rect = element.getBoundingClientRect();
        return {
            x: rect.left + rect.width / 2 + window.pageXOffset, // Add horizontal scroll offset
            y: rect.top + rect.height / 2 + window.pageYOffset   // Add vertical scroll offset
        };
    }

    // Function to create and position a line between two points
    function drawLine(start, end) {
        const length = Math.sqrt((end.x - start.x) ** 2 + (end.y - start.y) ** 2);
        const angle = Math.atan2(end.y - start.y, end.x - start.x) * (180 / Math.PI);

        // Create or update the line
        if (!line) {
            line = document.createElement('div');
            line.classList.add('line');
            document.body.appendChild(line);
        }

        // Set the position, length, and rotation of the line
        line.style.width = length + 'px';
        line.style.top = start.y + 'px';
        line.style.left = start.x + 'px';
        line.style.transform = `rotate(${angle}deg)`;
    }

    // When dragging starts on element X
    elementX.addEventListener('dragstart', (event) => {
        dragSource = event.target;
        event.dataTransfer.effectAllowed = 'move';
    });

    // When dragging over element Y (to allow drop)
    elementY.addEventListener('dragover', (event) => {
        event.preventDefault();
    });

    // When the drag ends on element Y (drop occurs)
    elementY.addEventListener('drop', (event) => {
        event.preventDefault();
        if (dragSource === elementX) {
            console.log('Drag occurred from X to Y');
            alert('Drag occurred from X to Y');

            // Get the center coordinates of both elements
            const start = getCenterCoordinates(elementX);
            const end = getCenterCoordinates(elementY);

            // Draw a line between the centers of X and Y
            drawLine(start, end);
        }
    });
</script>

</body>
</html>
